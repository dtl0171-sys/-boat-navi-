<!DOCTYPE html>
<html>
<head><title>Tile Test</title></head>
<body style="background:#0A1628;color:#00E5FF;font-family:sans-serif;padding:20px;">
<h2>Tile Loading Test</h2>

<h3>1. IMG tag (no CORS):</h3>
<img id="img1" width="256" height="256" style="border:1px solid #00E5FF;">

<h3>2. Fetch API (CORS):</h3>
<div id="fetch-result">Testing...</div>
<canvas id="canvas1" width="256" height="256" style="border:1px solid #00E5FF;"></canvas>

<h3>3. XMLHttpRequest (CORS):</h3>
<div id="xhr-result">Testing...</div>
<canvas id="canvas2" width="256" height="256" style="border:1px solid #00E5FF;"></canvas>

<script>
var tileUrl = 'https://tile.openstreetmap.org/6/56/25.png';

// Test 1: Simple img tag
document.getElementById('img1').src = tileUrl;
document.getElementById('img1').onload = function() {
  document.querySelector('h3:nth-of-type(1)').textContent += ' OK!';
};
document.getElementById('img1').onerror = function(e) {
  document.querySelector('h3:nth-of-type(1)').textContent += ' FAILED!';
};

// Test 2: Fetch API
fetch(tileUrl)
  .then(function(r) {
    document.getElementById('fetch-result').textContent = 'Status: ' + r.status + ' ' + r.statusText;
    return r.blob();
  })
  .then(function(blob) {
    var img = new Image();
    img.onload = function() {
      var ctx = document.getElementById('canvas1').getContext('2d');
      ctx.drawImage(img, 0, 0);
      document.getElementById('fetch-result').textContent += ' - Image drawn OK!';
    };
    img.src = URL.createObjectURL(blob);
  })
  .catch(function(e) {
    document.getElementById('fetch-result').textContent = 'FAILED: ' + e.message;
  });

// Test 3: XMLHttpRequest
var xhr = new XMLHttpRequest();
xhr.open('GET', tileUrl);
xhr.responseType = 'blob';
xhr.onload = function() {
  document.getElementById('xhr-result').textContent = 'Status: ' + xhr.status;
  var img = new Image();
  img.onload = function() {
    var ctx = document.getElementById('canvas2').getContext('2d');
    ctx.drawImage(img, 0, 0);
    document.getElementById('xhr-result').textContent += ' - Image drawn OK!';
  };
  img.src = URL.createObjectURL(xhr.response);
};
xhr.onerror = function() {
  document.getElementById('xhr-result').textContent = 'FAILED: XHR error';
};
xhr.send();
</script>
</body>
</html>
